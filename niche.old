
\documentstyle[12pt]{article}
\title{Tournament Selection and the Loss of Genetic Diversity}
\author{David E. Goldberg\\S. J. Chang\\C. K. Oei}
\begin{document}
\maketitle
\input epsf

{\noindent\narrower
Abstract:
In this article we examine tournament selection when used in combination with
several
mechanisms for preserving genetic diversity.  We make analytical predictions
for the rate of loss of genetic diversity for sharing and Boltzman tournament
selection, and propose a new method.  We test our predictions using computer
simulations.
}

\section{Introduction}
Tournament selection has several advantages over other methods of selection:
low noise, local interactions, and rank-based selection.  Unfortunately,
attempts at preserving genetic diversity through sharing and tournament
selection have been unsatisfactory because they require a large population to
sustain the niches.

\section{Tournament Selectiona and Sharing}
To see why tournament selection runs into problems when combined with niching,
let us consider the following simple model.  Consider a population of
single-bit strings, each with equal fitness.  Sharing makes the sub-population
with the least number of members the most fit, after the sharing is taken into
account.  Let $n$ be the number of 1's in the population, which is of size $N$.
Then the time evolution of the system is given by:
\begin{equation}
n_+=\left\{ \begin{array}{ll}
	\frac{n^2}{N} & \mbox{for $n>N/2$} \\
	\frac{n^2}{N} + 2 \frac{(N-n)n}{N} & \mbox{for $n<N/2$}
	\end{array}
\right. 
\end{equation}
where $n_+$ is the number of 1's in the next generation.  It is easier to
see what is happening if we look at the ratio of the number of 1's to the
total population: $r=n/N$.  The evolution becomes:
\begin{equation}
r_+=\left\{ \begin{array}{ll}
	r^2 & \mbox{for $r>1/2$}\\
	-r^2+2r & \mbox{for $r<1/2$}
	\end{array}
\right.
\end{equation}
If sharing works, then $r=1/2$ should be a stable fixed point of this mapping.
Notice, however, that the mapping is actually discontinuous at $r=1/2$.
If we start with almost the same number of 0's as 1's, with slightly more 1's,
then in a single generation the ratio would jump to 3:1 in favor of the 0's.
The method of sharing overcompensates and overshoots the equilibrium.

The system has two unstable fixed points of order 1 at 0 and 1, and two unstable
fixed points of order 2 at $\frac{3-5^{1/2}}{2}$ and $\frac{5^{1/2}-1}{2}$.
In fact, since the slope of the mapping is always greater than 1, there are
no stable fixed points anywhere and thus the trajectory of the system is
always aperiodic.  We verified numerically that the system is in fact chaotic
with a Lyapunov exponent of about $0.21$.

If we think of the system in terms of control theory, then what we are trying
to do is to control a system that would, if left by itself, drift away
from the desired equilibrium.  In this case, our controlling force is too
strong, and the 1-generation time lag between the measurement of the system
and the application of the control causes the controlled system to overshoot
the equilibrium, causing feedback and chaos.  We will use this point of view
to correct the situation later in this paper.

Actually, the fact that the system is chaotic does not really tell us that
sharing does not work.  In order to show that sharing fails we must estimate
the rate of loss of genetic diversity, and to do this, we will use a more
involved model.  Instead of thinking of two sub-populations, we will consider
a system with many sub-populations and assume that what happens in one
sub-population does not directly affect what happens in another population.
This model is similar to the mean-field theory that is often used to describe
the behavior of physical systems.  Let us assume we have a large population
of size $N$ with $k_0$ sub-populations at time $t=0$.  
Again, we will take all the fitness values to be equal for now.

Let $p(k,x,t)$ be the number of individuals at
time $t$ in the $x$-th niche, where the
niches are sorted according to their sizes and $k=k(t)$ is the number of
niches remaining at time $t$.  The largest niche will have
$p(k,k,t)$ members and the smallest niche will have $p(k,1,t)$ members.  What we
expect is that for large $k$, the system will quickly collapse onto
a slow manifold that does not depend on the initial conditions except for
the value of $N$ and $k_0$.
Let us work in the rescaled population distribution:
\begin{equation}
F(x/k,t)=\frac{k}{N} p(k,x,t)
\end{equation}
What we are guessing is that as time progresses, the system loses more and
more niches, but the rescaled population distribution remains unchanged.
If such a quasi-steady-state solution exists, it is given by:
\begin{equation}
F^*(y)=\lim_{t \rightarrow \infty} F(y,t)
\end{equation}
So if our quasi-steady-state assumption holds, then
when we have a large number of niches ($k \gg 1$)
and evolution has taken place for a while ($t \gg 1$), 
$p(k,x,t)$ follows a simple scaling law:
\begin{equation}
p(k,x,t) \approx \frac{N}{k} F^*(x/k)
\end{equation}
We verified this scaling law numerically.  It turns out that it is possible
to solve for this quasi-steady-state solution, $F^*$ analytically.
The key is to postulate the existance of a solution $F^*(y)$
that is symmetric about $y=1/2$ after the tournament reproduction phase; that is, the
most endangered niches remain highly endangered, the most populated
niches become endangered, and the niches in between the extremes
remain about the same.  Numerical studies pointed out this symmetry.
Using these assumptions, we can write the time evolution of the system
as follows:

Since all the fitnesses are equal, the outcome the tournaments depends
only on how many individuals are in the niches.  Let $F_t$ be the
rescaled population distribution after the tournament phase.  Since
the niches are ranked according to their sizes, we can take the expectation:
\begin{equation}
F_t(x)=2\int_x^1{dy\,F(x) F(y)}
\end{equation}

After the tournament phase, some of the niches that were heavily
populated are no longer heavily populated, and some of the niches that
were endangered are no longer endangered.  This means that we must resort
the niches according to their new sizes.  Ordinarily, this would be
extremely difficult to do analytically, but
because the solution is symmetric by assumption, the sorting phase is
given by:
\begin{equation}
F_{s}(x)=F_t(x/2)
\end{equation}

Now we just renormalize the probability distribution so that the integral
is unity:
\begin{equation}
F_+(x)=C F_s(x)
\end{equation}

Now we can write the time evolution of the system as an operator equation:
\begin{equation}
F_{t+1}(x)=\Psi[F_t(x)]
\end{equation}
where the operator $\Psi$ is given by:
\begin{equation}
\Psi[w(x)]=\Phi[w(x)]/\int_0^1{dx\, \Phi[w(x)]}
\end{equation}
\begin{equation}
\Phi[w(x)]=w(x/2)\int_{x/2}^1{dy\,w(y)}
\end{equation}
For the quasi-steady-state solution, we must solve:
\begin{equation}
F^*(x)=\Psi[F^*(x)]
\end{equation}
These equations are straightforward to solve, yielding the quasi-steady-state
solution:
\begin{equation}
F(x)=\frac{\pi}{2}\sin(\frac{\pi x}{2})
\end{equation}
It is straightforward to verify that after the tournament phase, this
solution is symmetric about $x=1/2$, and so we have a self-consistent
solution.  The fact that numerical experiments agree with this analysis
indicates that this is indeed a stable solution.

\begin{figure}
\epsfbox{predpop.eps}
\caption{Continuum and Mean Field Comparisons}
\end{figure}

\begin{figure}
\epsfbox{empvscon.eps}
\caption{Continuum and Empirical Comparisons}
\end{figure}

Now that we have the distribution of the population, it is straightforward
to compute the probability that a certain sub-population will lose every
tournament that it enters, in the mean-field approximation.  This will
tell us how the number of niches, $k$, depends on time.
The rate of loss is
\begin{equation}
\int_0^k{dx\,(\int_0^{x/k}\frac{\pi}{2}\sin(\frac{\pi}{2}y)dy)^{
	\frac{\pi N}{2 k} 2 \sin(\frac{\pi x}{2 k}}}
\end{equation}
The factor of two in the exponent comes because each individual enters
twice in tournaments.

A little massaging gives
\begin{equation}
k \int_0^1{dx\,(1-\cos(\frac{\pi x}{2}))^{\frac{\pi N}{k} \sin(\frac{\pi x}{2})}}
\end{equation}
\begin{equation}
k G(N/k)
\end{equation}
It can be shown that only the values of the integrand near the endpoint at $x=1$
matters in the integral when $N/k$ is large.  Doing the asymptotic
expansion yields:

\begin{equation}
\frac{\partial k}{\partial t}=-\frac{2}{\pi^2}\frac{k^2}{N}
\end{equation}

\begin{equation}
k=\frac{1}{\frac{1}{k_0}+\frac{2t}{\pi^2 N}}
\end{equation}

The following are two numerical studies to check this result.  We used
a fixed number of individuals per niche, varied the number of niches in
the initial population, and asked how many niches survive fifty generations.
\begin{figure}
\epsfbox{survniche.eps}
\caption{Number of niches that survive 50 generations vs. initial number of niches}
\end{figure}
We also took a single run and asked how many niches survived as a function
of time.
\begin{figure}
\epsfbox{survnic2.eps}
\end{figure}

\section{Boltzman Tournament Selection}

To analyze Boltzman tournament selection, we can use generating functions.
Let $l$ represent the state with a single individual; $l^2$ represents
the state with two individuals; $\frac{1}{2}(1+l}$ represents the
state which has fifty percent probability of having no individuals, and
fifty precent probability of having one individual.  Using this notation,
we can write the time evolution of the niche in the mean-field approximation

\begin{eqnarray}
g(l,0)&=&l^n \\
g(l,t)&=&g((\frac{l+1}{2})^2,t-1)
\end{eqnarray}



\begin{figure}
\epsfbox{bolztourn.eps}
\caption{500 niches, 10 people/niche}
\end{figure}

\begin{figure}
\epsfbox{bolztourn2.eps}
\caption{500 niches, 17 people/niche}
\end{figure}

\section{Continuous Update Tournament Selection}

\end{document}

